"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["2048"],{27062:function(e,t,a){a.d(t,{Z:()=>n});var l=a(58786),i=a(82518),s=a(86223);function n(e={},t){let a=(0,l.qj)({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:r,keyup:o}=e,u=e=>{switch(e.key){case"Control":a.ctrl=!0;break;case"Meta":a.command=!0,a.win=!0;break;case"Shift":a.shift=!0;break;case"Tab":a.tab=!0}void 0!==r&&Object.keys(r).forEach(t=>{if(t!==e.key)return;let a=r[t];if("function"==typeof a)a(e);else{let{stop:t=!1,prevent:l=!1}=a;t&&e.stopPropagation(),l&&e.preventDefault(),a.handler(e)}})},d=e=>{switch(e.key){case"Control":a.ctrl=!1;break;case"Meta":a.command=!1,a.win=!1;break;case"Shift":a.shift=!1;break;case"Tab":a.tab=!1}void 0!==o&&Object.keys(o).forEach(t=>{if(t!==e.key)return;let a=o[t];if("function"==typeof a)a(e);else{let{stop:t=!1,prevent:l=!1}=a;t&&e.stopPropagation(),l&&e.preventDefault(),a.handler(e)}})},c=()=>{(void 0===t||t.value)&&((0,i.on)("keydown",document,u),(0,i.on)("keyup",document,d)),void 0!==t&&(0,l.YP)(t,e=>{e?((0,i.on)("keydown",document,u),(0,i.on)("keyup",document,d)):((0,i.S)("keydown",document,u),(0,i.S)("keyup",document,d))})};return(0,s.N)()?((0,l.wF)(c),(0,l.Jd)(()=>{(void 0===t||t.value)&&((0,i.S)("keydown",document,u),(0,i.S)("keyup",document,d))})):c(),(0,l.OT)(a)}},46471:function(e,t,a){a.d(t,{Z:()=>p});var l=a(32510),i=a(91792),s=a(75266),n=a(3073),r=a(67737),o=a(4339),u=a(98168),d=a(77407),c=Object.prototype.hasOwnProperty;let p=function(e){if(null==e)return!0;if((0,r.Z)(e)&&((0,n.Z)(e)||"string"==typeof e||"function"==typeof e.splice||(0,o.Z)(e)||(0,d.Z)(e)||(0,s.Z)(e)))return!e.length;var t=(0,i.Z)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if((0,u.Z)(e))return!(0,l.Z)(e).length;for(var a in e)if(c.call(e,a))return!1;return!0}},66236:function(e,t,a){a.d(t,{W3:()=>c,ZP:()=>m});var l=a(58786),i=a(56946),s=a(54470),n=a(53198),r=a(19050),o=a(55456),u=a(71309);let d=(0,u.cB)("breadcrumb",`
 white-space: nowrap;
 cursor: default;
 line-height: var(--n-item-line-height);
`,[(0,u.c)("ul",`
 list-style: none;
 padding: 0;
 margin: 0;
 `),(0,u.c)("a",`
 color: inherit;
 text-decoration: inherit;
 `),(0,u.cB)("breadcrumb-item",`
 font-size: var(--n-font-size);
 transition: color .3s var(--n-bezier);
 display: inline-flex;
 align-items: center;
 `,[(0,u.cB)("icon",`
 font-size: 18px;
 vertical-align: -.2em;
 transition: color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 `),(0,u.c)("&:not(:last-child)",[(0,u.cM)("clickable",[(0,u.cE)("link",`
 cursor: pointer;
 `,[(0,u.c)("&:hover",`
 background-color: var(--n-item-color-hover);
 `),(0,u.c)("&:active",`
 background-color: var(--n-item-color-pressed); 
 `)])])]),(0,u.cE)("link",`
 padding: 4px;
 border-radius: var(--n-item-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 position: relative;
 `,[(0,u.c)("&:hover",`
 color: var(--n-item-text-color-hover);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-hover);
 `)]),(0,u.c)("&:active",`
 color: var(--n-item-text-color-pressed);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-pressed);
 `)])]),(0,u.cE)("separator",`
 margin: 0 8px;
 color: var(--n-separator-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 `),(0,u.c)("&:last-child",[(0,u.cE)("link",`
 font-weight: var(--n-font-weight-active);
 cursor: unset;
 color: var(--n-item-text-color-active);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-active);
 `)]),(0,u.cE)("separator",`
 display: none;
 `)])])]),c=(0,r.U)("n-breadcrumb"),p=Object.assign(Object.assign({},i.Z.props),{separator:{type:String,default:"/"}}),m=(0,l.aZ)({name:"Breadcrumb",props:p,setup(e){let{mergedClsPrefixRef:t,inlineThemeDisabled:a}=(0,s.ZP)(e),r=(0,i.Z)("Breadcrumb","-breadcrumb",d,o.Z,e,t);(0,l.JJ)(c,{separatorRef:(0,l.Vh)(e,"separator"),mergedClsPrefixRef:t});let u=(0,l.Fl)(()=>{let{common:{cubicBezierEaseInOut:e},self:{separatorColor:t,itemTextColor:a,itemTextColorHover:l,itemTextColorPressed:i,itemTextColorActive:s,fontSize:n,fontWeightActive:o,itemBorderRadius:u,itemColorHover:d,itemColorPressed:c,itemLineHeight:p}}=r.value;return{"--n-font-size":n,"--n-bezier":e,"--n-item-text-color":a,"--n-item-text-color-hover":l,"--n-item-text-color-pressed":i,"--n-item-text-color-active":s,"--n-separator-color":t,"--n-item-color-hover":d,"--n-item-color-pressed":c,"--n-item-border-radius":u,"--n-font-weight-active":o,"--n-item-line-height":p}}),p=a?(0,n.F)("breadcrumb",void 0,u,e):void 0;return{mergedClsPrefix:t,cssVars:a?void 0:u,themeClass:null==p?void 0:p.themeClass,onRender:null==p?void 0:p.onRender}},render(){var e;return null==(e=this.onRender)||e.call(this),(0,l.h)("nav",{class:[`${this.mergedClsPrefix}-breadcrumb`,this.themeClass],style:this.cssVars,"aria-label":"Breadcrumb"},(0,l.h)("ul",null,this.$slots))}})},70958:function(e,t,a){a.d(t,{Z:()=>r});var l=a(58786),i=a(93950),s=a(68574),n=a(66236);let r=(0,l.aZ)({name:"BreadcrumbItem",props:{separator:String,href:String,clickable:{type:Boolean,default:!0},onClick:Function},slots:Object,setup(e,{slots:t}){let a=(0,l.f3)(n.W3,null);if(!a)return()=>null;let{separatorRef:r,mergedClsPrefixRef:o}=a,u=function(e=s.j?window:null){let t=()=>{let{hash:t,host:a,hostname:l,href:i,origin:s,pathname:n,port:r,protocol:o,search:u}=(null==e?void 0:e.location)||{};return{hash:t,host:a,hostname:l,href:i,origin:s,pathname:n,port:r,protocol:o,search:u}},a=(0,l.iH)(t()),i=()=>{a.value=t()};return(0,l.bv)(()=>{e&&(e.addEventListener("popstate",i),e.addEventListener("hashchange",i))}),(0,l.SK)(()=>{e&&(e.removeEventListener("popstate",i),e.removeEventListener("hashchange",i))}),a}(),d=(0,l.Fl)(()=>e.href?"a":"span"),c=(0,l.Fl)(()=>u.value.href===e.href?"location":null);return()=>{let{value:a}=o;return(0,l.h)("li",{class:[`${a}-breadcrumb-item`,e.clickable&&`${a}-breadcrumb-item--clickable`]},(0,l.h)(d.value,{class:`${a}-breadcrumb-item__link`,"aria-current":c.value,href:e.href,onClick:e.onClick},t),(0,l.h)("span",{class:`${a}-breadcrumb-item__separator`,"aria-hidden":"true"},(0,i.gI)(t.separator,()=>{var t;return[null!=(t=e.separator)?t:r.value]})))}}})},50144:function(e,t,a){a.d(t,{Z:()=>u});var l=a(58786),i=a(56946),s=a(54470),n=a(49942),r=a(44108);let o=Object.assign(Object.assign({},n.Kd),i.Z.props),u=(0,l.aZ)({name:"Tooltip",props:o,slots:Object,__popover__:!0,setup(e){let{mergedClsPrefixRef:t}=(0,s.ZP)(e),a=(0,i.Z)("Tooltip","-tooltip",void 0,r.Z,e,t),n=(0,l.iH)(null);return Object.assign(Object.assign({},{syncPosition(){n.value.syncPosition()},setShow(e){n.value.setShow(e)}}),{popoverRef:n,mergedTheme:a,popoverThemeOverrides:(0,l.Fl)(()=>a.value.self)})},render(){let{mergedTheme:e,internalExtraClass:t}=this;return(0,l.h)(n.ZP,Object.assign(Object.assign({},this.$props),{theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,builtinThemeOverrides:this.popoverThemeOverrides,internalExtraClass:t.concat("tooltip"),ref:"popoverRef"}),this.$slots)}})},84075:function(e,t,a){a.d(t,{WH:()=>n,Z2:()=>c,gV:()=>v,hI:()=>s,iE:()=>d,mD:()=>u,sS:()=>o,uz:()=>m,yG:()=>p,yL:()=>r});var l=a(34541);let{t:i}=a(76882).ag.global,s=e=>l.e.get("/contact/group/list",{params:e}),n=()=>l.e.get("/contact/group/all"),r=e=>l.e.get("/contact/group/info",{params:e}),o=e=>l.e.post("/contact/group/create",e,{fetchOptions:{loading:i("contacts.group.loading.createGroup"),successMessage:!0}}),u=e=>l.e.post("/contact/group/update",e,{fetchOptions:{loading:i("contacts.group.loading.updateGroup"),successMessage:!0}}),d=e=>l.e.post("/contact/group/delete",e,{fetchOptions:{loading:i("contacts.group.loading.deleteGroup"),successMessage:!0}}),c=e=>l.e.post("/contact/group/tag_contact_count",e),p=e=>l.e.post("/contact/group/export",e,{responseType:"blob",fetchOptions:{loading:i("contacts.group.loading.exportGroup"),successMessage:!0}}),m=e=>l.e.post("/contact/group/update",e,{fetchOptions:{loading:i("contacts.group.loading.saveSettings"),successMessage:!0}}),v=e=>l.e.post("/contact/group/update_unsubscribe",e,{fetchOptions:{loading:i("contacts.group.loading.saveSettings"),successMessage:!0}})},39432:function(e,t,a){a.d(t,{Aj:()=>h,Au:()=>p,Fj:()=>o,LC:()=>n,Lb:()=>_,M7:()=>b,OV:()=>c,dj:()=>d,gK:()=>u,i7:()=>s,nf:()=>k,qt:()=>r,rU:()=>f,v1:()=>m,xh:()=>g,yW:()=>v});var l=a(34541);let{t:i}=a(76882).ZP.global,s=e=>l.e.get("/domains/list",{params:e}),n=()=>l.e.get("/domains/all"),r=()=>l.e.post("/multi_ip_domain/apply"),o=e=>l.e.post("/domains/create",e,{fetchOptions:{loading:i("domain.api.loading.creating"),successMessage:!0}}),u=e=>l.e.post("/domains/update",e,{fetchOptions:{loading:i("domain.api.loading.updating"),successMessage:!0}}),d=e=>l.e.post("/domains/delete",e,{fetchOptions:{loading:i("domain.api.loading.deleting"),successMessage:!0}}),c=e=>l.e.post("/domains/set_ssl",e,{fetchOptions:{loading:i("domain.api.loading.settingSSL"),successMessage:!0}}),p=e=>l.e.get("/domains/get_ssl",{params:e}),m=e=>l.e.post("/domains/fresh_dns_records",e,{fetchOptions:{loading:i("domain.api.loading.refreshingDns"),successMessage:!0}}),v=e=>l.e.post("/ssl/apply_cert",e,{fetchOptions:{loading:i("domain.api.loading.applyingCert"),successMessage:!0}}),g=e=>l.e.post("/domains/set_default_domain",e,{fetchOptions:{loading:i("domain.api.loading.settingDefault"),successMessage:!0}}),f=e=>l.e.post("/askai/project/create",e,{fetchOptions:{loading:i("domain.api.loading.settingBrandInfo"),successMessage:!0}}),b=e=>l.e.post("/multi_ip_domain/test",e,{fetchOptions:{loading:i("domain.api.loading.testingConnection"),successMessage:!0}}),_=()=>l.e.post("/askai/supplier/status"),k=e=>l.e.post("/domain_blocklist/check",e,{fetchOptions:{loading:"Detecting, please wait...",successMessage:!0}}),h=e=>l.e.get("/domain_blocklist/logs",{params:e})},67127:function(e,t,a){a.d(t,{EV:()=>o,H2:()=>c,Ts:()=>n,WS:()=>u,Yi:()=>r,iC:()=>s,ym:()=>d});var l=a(34541);let{t:i}=a(76882).ZP.global,s=e=>l.e.get("/mailbox/list",{params:e}),n=e=>l.e.post("/mailbox/create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),r=e=>l.e.post("/mailbox/batch_create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),o=e=>l.e.post("/mailbox/update",e,{fetchOptions:{loading:i("mailbox.api.loading.updating"),successMessage:!0}}),u=e=>l.e.post("/mailbox/delete",e,{fetchOptions:{loading:i("mailbox.api.loading.deleting"),successMessage:!0}}),d=e=>l.e.post("/mailbox/export",e,{responseType:"blob",fetchOptions:{loading:i("mailbox.api.loading.exporting"),successMessage:!0}}),c=e=>l.e.post("/mailbox/import",e,{fetchOptions:{loading:i("mailbox.api.loading.importing"),successMessage:!0}})},55855:function(e,t,a){a.d(t,{Gk:()=>r,Q5:()=>m,Xr:()=>p,ZS:()=>n,_5:()=>c,gI:()=>u,jC:()=>v,ke:()=>g,mQ:()=>o,oS:()=>f,xJ:()=>d});var l=a(76882),i=a(34541);let{t:s}=l.ag.global;function n(e){return i.e.get("/batch_mail/task/list",{params:e})}function r(e){return i.e.get("/batch_mail/task/stat_chart",{params:e})}function o(e){return i.e.get("/batch_mail/task/find",{params:e})}function u(e){return i.e.post("/batch_mail/task/create",e,{fetchOptions:{loading:s("market.task.loading.creating"),successMessage:!0}})}function d(e){return i.e.post("/batch_mail/task/update",e,{fetchOptions:{loading:s("market.task.loading.updating"),successMessage:!0}})}function c(e){return i.e.post("/batch_mail/task/delete",e,{fetchOptions:{loading:s("market.task.loading.deleting"),successMessage:!0}})}function p(e){return i.e.post("/batch_mail/task/pause",e,{fetchOptions:{loading:s("market.task.loading.pausing"),successMessage:!0}})}function m(e){return i.e.post("/batch_mail/task/resume",e,{fetchOptions:{loading:s("market.task.loading.resuming"),successMessage:!0}})}function v(e){return i.e.post("/batch_mail/task/send_test",e,{fetchOptions:{loading:s("market.task.loading.sendingTest"),successMessage:!0}})}function g(e){return i.e.get("/batch_mail/tracking/mail_provider",{params:e})}function f(e){return i.e.get("/batch_mail/tracking/logs",{params:e})}},31651:function(e,t,a){a.d(t,{A8:()=>n,NI:()=>r,QB:()=>d,WF:()=>u,Xc:()=>p,ef:()=>c,ij:()=>o});var l=a(76882),i=a(34541);let{t:s}=l.ZP.global;function n(e){return i.e.get("/email_template/list",{params:e})}function r(){return i.e.get("/email_template/all")}function o(e){return i.e.get("/email_template/get",{params:e})}function u(e){return i.e.post("/email_template/create",e,{fetchOptions:{loading:s("market.template.loading.creating"),successMessage:!0}})}function d(e){return i.e.post("/email_template/update",e,{fetchOptions:{loading:s("market.template.loading.updating"),successMessage:!0}})}function c(e){return i.e.post("/email_template/copy",e,{fetchOptions:{loading:s("market.template.loading.copying"),successMessage:!0}})}function p(e){return i.e.post("/email_template/delete",e,{fetchOptions:{loading:s("market.template.loading.deleting"),successMessage:!0}})}},43458:function(e,t,a){a.d(t,{CZ:()=>n,Lp:()=>u,Pn:()=>o,Rc:()=>d,kV:()=>s,ln:()=>r});var l=a(34541);let{t:i}=a(76882).ag.global,s=e=>l.e.get("/tags/list",{params:e}),n=e=>l.e.get("/tags/all",{params:e}),r=e=>l.e.post("/tags/create",e,{fetchOptions:{loading:i("contacts.tags.loading.creating"),successMessage:!0}}),o=e=>l.e.post("/tags/delete",e,{fetchOptions:{loading:i("contacts.tags.loading.deleting"),successMessage:!0}}),u=e=>l.e.post("/tags/update",e,{fetchOptions:{loading:i("contacts.tags.loading.updating"),successMessage:!0}}),d=e=>l.e.post("/tags/batch_contacts",e,{fetchOptions:{loading:i("contacts.tags.loading.bulkSetting"),successMessage:!0}})},53472:function(e,t,a){a.d(t,{Z:()=>s});var l=a(58786);let i=["height","srcdoc"],s=(0,l.aZ)({__name:"index",props:{value:{type:String,default:""},height:{type:[String,Number],default:"100%"}},setup:e=>(t,a)=>((0,l.wg)(),(0,l.iD)("iframe",{width:"100%",height:e.height,srcdoc:e.value,style:{border:"none",borderRadius:"4px"}},null,8,i))})},19664:function(e,t,a){a.d(t,{Z:()=>d});var l=a(8490),i=a(58786),s=a(68271),n=a(39432),r=a(67127);let o={class:"flex-1"},u={class:"flex-1 ml-10px"},d=(0,i.aZ)({__name:"FromSelect",props:{value:{},valueModifiers:{},name:{},nameModifiers:{},domain:{},domainModifiers:{}},emits:["update:value","update:name","update:domain"],setup(e){let t=(0,i.tT)(e,"value"),a=(0,i.tT)(e,"name"),d=(0,i.iH)(!1),c=(0,i.tT)(e,"domain"),p=(0,i.iH)([]),m=(0,i.iH)([]),v=(0,i.Fl)(()=>m.value.filter(e=>e.domain===c.value).map(e=>({label:e.username,value:e.username,data:e}))),g=async()=>{await (0,i.Y3)(),v.value.length>0?(t.value=v.value[0].value,f(t.value,v.value[0])):(t.value=null,a.value="")},f=(e,t)=>{let{data:l}=t;(0,s.Kn)(l)&&(a.value=l.full_name)},b=async()=>{let e=await (0,n.LC)();if((0,s.kJ)(e)&&(p.value=e.map(e=>({label:e.domain,value:e.domain})),!c.value&&e.length>0)){let t=e.filter(e=>e.default);t.length>0?c.value=t[0].domain:c.value=e[0].domain}},_=async()=>{let e=await (0,r.iC)({page:1,page_size:1e3,domain:""});(0,s.Kn)(e)&&(m.value=e.list)};return(async()=>{try{d.value=!0,await _(),await b(),await (0,i.Y3)(),null===t.value?g():t.value&&(c.value=t.value.split("@")[1])}finally{d.value=!1}})(),(e,a)=>{let s=l.Z;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",o,[(0,i.Wm)(s,{value:c.value,"onUpdate:value":[a[0]||(a[0]=e=>c.value=e),g],loading:(0,i.SU)(d),options:(0,i.SU)(p)},null,8,["value","loading","options"])]),(0,i._)("div",u,[(0,i.Wm)(s,{value:t.value,"onUpdate:value":[a[1]||(a[1]=e=>t.value=e),f],loading:(0,i.SU)(d),options:(0,i.SU)(v),filterable:!0},null,8,["value","loading","options"])])],64)}}})},28444:function(e,t,a){a.d(t,{Z:()=>r});var l=a(8490),i=a(58786),s=a(68271),n=a(31651);let r=(0,i.aZ)({__name:"TemplateSelect",props:{value:{},valueModifiers:{},content:{},contentModifiers:{}},emits:(0,i.Vf)(["listReady"],["update:value","update:content"]),setup(e,t){let{emit:a}=t,r=(0,i.tT)(e,"value"),o=(0,i.tT)(e,"content"),u=(0,i.iH)(!1),d=(0,i.iH)([]),c=(e,t)=>{let{data:a}=t;(0,s.Kn)(a)&&(o.value=a.html_content)};return(async()=>{try{u.value=!0;let e=await (0,n.NI)();if((0,s.kJ)(e)){if(d.value=e.map(e=>({label:e.temp_name,value:e.id,data:e})),null===r.value)r.value=e[0].id,o.value=e[0].html_content;else{let t=e.find(e=>e.id===r.value);t&&(o.value=t.html_content)}a("listReady",e)}}finally{u.value=!1}})(),(e,t)=>{let a=l.Z;return(0,i.wg)(),(0,i.j4)(a,{value:r.value,"onUpdate:value":[t[0]||(t[0]=e=>r.value=e),c],loading:(0,i.SU)(u),filterable:!0,options:(0,i.SU)(d)},null,8,["value","loading","options"])}}})},7189:function(e,t,a){a.r(t),a.d(t,{default:()=>eg});var l=a(53472),i=a(46244),s=a(17977),n=a(57869),r=a(29283),o=a(16715),u=a(2352),d=a(29875),c=a(15496),p=a(81833),m=a(37864),v=a(8490),g=a(73084),f=a(6455),b=a(66236),_=a(70958),k=a(58786),h=a(31708),w=a(94821),U=a(68271),S=a(55855),y=a(19664),x=a(51169),Z=a(84075),W=a(3179),O=a(46471),j=a(98003),M=a(52495);let C={class:"pt-12px"},$={class:"flex-1"},z={class:"mt-8px text-12px text-desc"},P=`email,attributes
example1@example.com,"{""age"": ""13"", ""Gender"": ""XXX""}"
example2@example.com,"{""age"": ""45"", ""city"": ""XXX""}"
`,T=(0,k.aZ)({__name:"CreateGroup",setup(e){let{t}=(0,M.QT)(),a=(0,k.AE)("formRef"),l=(0,k.qj)({create_type:2,name:"",file_data:"",file_type:"",description:"",status:1,double_optin:0}),s={name:{required:!0,message:t("market.task.createGroup.validation.groupNameRequired"),trigger:["blur","input"]}},n=[{label:"Confirmed",value:1},{label:"Unconfirmed",value:0}],r=e=>{let t=new FileReader;t.onload=t=>{var a;l.file_type=e.name.substring(e.name.lastIndexOf(".")+1),l.file_data=null==(a=t.target)?void 0:a.result},e.file&&t.readAsText(e.file)},o=async()=>{await (0,j.Sv)({file_path:"./template/example_recipients.csv"})},u=async()=>{var e;if(await (null==(e=a.value)?void 0:e.validate()),(0,O.Z)(l.file_data))return U.v0.error(t("contacts.subscribers.import.validation.fileRequired")),Promise.reject()},[d,p]=(0,x.d)({onChangeState:e=>{e&&(l.name="",l.file_data="",l.file_type="")},onConfirm:async()=>{await u(),await (0,Z.sS)((0,k.IU)(l));let e=p.getState();null==e||e.refresh()}});return(e,u)=>{let p=g.Z,m=f.ZP,b=v.Z,_=W.Z,h=c.ZP,w=i.Z;return(0,k.wg)(),(0,k.j4)((0,k.SU)(d),{title:(0,k.SU)(t)("market.task.createGroup.title"),width:"500"},{default:(0,k.w5)(()=>[(0,k._)("div",C,[(0,k.Wm)(w,{ref_key:"formRef",ref:a,model:(0,k.SU)(l),rules:s},{default:(0,k.w5)(()=>[(0,k.Wm)(m,{label:(0,k.SU)(t)("market.task.createGroup.groupName"),path:"name"},{default:(0,k.w5)(()=>[(0,k.Wm)(p,{value:(0,k.SU)(l).name,"onUpdate:value":u[0]||(u[0]=e=>(0,k.SU)(l).name=e),placeholder:(0,k.SU)(t)("market.task.createGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,k.Wm)(m,{label:"Status"},{default:(0,k.w5)(()=>[(0,k.Wm)(b,{value:(0,k.SU)(l).status,"onUpdate:value":u[1]||(u[1]=e=>(0,k.SU)(l).status=e),options:n},null,8,["value"])]),_:1}),(0,k.Wm)(m,{label:(0,k.SU)(t)("market.task.createGroup.email"),path:"file_data"},{default:(0,k.w5)(()=>[(0,k._)("div",$,[(0,k.Wm)(_,{"is-upload":!1,accept:["csv"],onChange:r}),(0,k._)("div",z,[(0,k.Uk)((0,k.zw)(e.$t("contacts.subscribers.import.fileTypeHint"))+" ",1),(0,k.Wm)(h,{text:"",type:"primary",onClick:o},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("common.actions.download")),1)]),_:1})])])]),_:1},8,["label"]),(0,k.Wm)(m,{label:e.$t("contacts.subscribers.import.exampleCsvLabel")},{default:(0,k.w5)(()=>[(0,k._)("pre",{class:"csv-example"},(0,k.zw)(P))]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var R=a(41748);let H=(0,R.default)(T,[["__scopeId","data-v-5210e9fa"]]),E={class:"flex-1"},q={class:"ml-12px"},N=(0,k.aZ)({__name:"GroupSelect",props:(0,k.Vf)({disabled:{type:Boolean,default:!1}},{value:{default:()=>0},valueModifiers:{},label:{default:()=>""},labelModifiers:{}}),emits:["update:value","update:label"],setup(e){let t=(0,k.tT)(e,"value"),a=(0,k.tT)(e,"label"),l=(0,k.iH)(!1),i=(0,k.iH)([]),[s,n]=(0,x.d)({component:H,state:{refresh:()=>{u()}}}),r=()=>{n.open()},o=async(e,t)=>{a.value=`${t.label}`},u=async()=>{try{l.value=!0;let e=await (0,Z.WH)();(0,U.Kn)(e)&&(i.value=e.list.map(e=>({label:e.name,value:e.id})))}finally{l.value=!1}};return u(),(a,n)=>{let u=v.Z,d=c.ZP;return(0,k.wg)(),(0,k.iD)(k.HY,null,[(0,k._)("div",E,[(0,k.Wm)(u,{value:t.value,"onUpdate:value":[n[0]||(n[0]=e=>t.value=e),o],options:(0,k.SU)(i),filterable:!0,disabled:e.disabled,"max-tag-count":"responsive",loading:(0,k.SU)(l),placeholder:a.$t("market.task.edit.recipientsPlaceholder")},null,8,["value","options","disabled","loading","placeholder"])]),(0,k._)("div",q,[(0,k.Wm)(d,{text:"",type:"primary",onClick:r},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(a.$t("common.actions.create")),1)]),_:1})]),(0,k.Wm)((0,k.SU)(s))],64)}}});var B=a(43458),D=a(65965);let G={class:"ml-12px"},I=(0,k.aZ)({__name:"TagSelect",props:(0,k.Vf)({groupId:{type:Number,default:null},disabled:{type:Boolean,default:!1}},{value:{default:()=>[]},valueModifiers:{}}),emits:["update:value"],setup(e){let t=(0,k.tT)(e,"value"),a=(0,D.tv)(),l=(0,k.iH)([]),i=(0,k.Fl)(()=>l.value.filter(t=>t.group_id===e.groupId).map(e=>({value:e.id,label:e.name}))),s=async()=>{let e=await (0,B.CZ)({});(0,U.Kn)(e)&&(l.value=e.list)},n=()=>{a.push("/contacts/tags")};return(0,k.YP)(()=>e.groupId,()=>{t.value=[]}),s(),(a,l)=>{let s=v.Z,r=c.ZP;return(0,k.wg)(),(0,k.iD)(k.HY,null,[(0,k.Wm)(s,{value:t.value,"onUpdate:value":l[0]||(l[0]=e=>t.value=e),options:(0,k.SU)(i),disabled:e.disabled,multiple:!0,filterable:!0,"max-tag-count":"responsive"},null,8,["value","options","disabled"]),(0,k._)("div",G,[(0,k.Wm)(r,{text:"",type:"primary",onClick:n},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(a.$t("common.actions.create")),1)]),_:1})])],64)}}});var F=a(28444);let L={class:"task-edit-container"},A={class:"flex flex-col flex-1 p-24px overflow-auto"},K={class:"flex-1"},V={class:"flex items-center"},Y={class:"flex-1"},X={class:"ml-12px text-desc"},J={class:"w-60px"},Q={class:"flex-1 mr-10px"},ee={class:"task-preview"},et={class:"preview-header"},ea={class:"preview-header-item"},el={class:"preview-label"},ei={class:"preview-value"},es={class:"preview-header-item"},en={class:"preview-label"},er={class:"preview-value"},eo={class:"preview-header-item"},eu={class:"preview-label"},ed={class:"preview-value"},ec={class:"preview-content"},ep={key:1,class:"empty-preview"},em={class:"action-buttons"},ev=(0,k.aZ)({__name:"edit",setup(e){let{t}=(0,M.QT)(),a=(0,D.yj)(),x=(0,D.tv)(),W=(0,h.s6)(),O=(0,k.AE)("formRef"),j=(0,k.AE)("formContentRef"),{height:C}=(0,w.rBN)(j),$=(0,k.iH)(!1),z=(0,k.iH)(0),P=(0,k.qj)({addresser:null,full_name:"",subject:"",group_id:null,template_id:null,is_record:1,unsubscribe:1,warmup:0,threads:0,start_time:null,remark:"",tag_ids:[],tag_logic:"OR"}),T=[{label:"OR",value:"OR"},{label:"AND",value:"AND"}],R={full_name:{trigger:["blur","input"],validator:()=>""!==P.full_name||Error(t("market.task.edit.validation.displayNameRequired"))},subject:{trigger:["blur","input"],validator:()=>""!==P.subject||Error(t("market.task.edit.validation.subjectRequired"))},group_ids:{trigger:"change",validator:()=>!!P.group_id||Error(t("market.task.edit.validation.recipientsRequired"))},template_id:{trigger:"change",validator:()=>null!==P.template_id||Error(t("market.task.edit.validation.templateRequired"))},start_time:{validator:()=>1!==B.value||null!==P.start_time||Error(t("market.task.edit.validation.sendTimeRequired"))}},H=(0,k.iH)(""),E=(0,k.iH)(0),q=(0,k.iH)(0),B=(0,k.iH)(0),G=(0,k.iH)(""),ev=(0,k.iH)(""),eg=()=>{x.push("/template")},ef=e=>{0===e?P.threads=0:P.threads=5},eb=()=>{0===B.value&&(P.start_time=null)},e_=async()=>G.value?P.subject?P.template_id?void await (0,S.jC)({addresser:P.addresser||"",subject:P.subject,recipient:G.value,template_id:P.template_id||0}):void U.v0.error(t("market.task.edit.validation.templateRequired")):void U.v0.error(t("market.task.edit.validation.subjectRequired")):void U.v0.error(t("market.task.edit.validation.testEmailRequired")),ek=()=>{P.subject||P.group_id?(0,U.iG)({title:t("market.task.edit.discard.title"),content:t("market.task.edit.discard.content"),onConfirm:()=>{x.go(-1)}}):x.go(-1)},eh=async()=>{if(!P.group_id){E.value=0;return}let e=await (0,Z.Z2)({group_id:P.group_id||0,tag_ids:P.tag_ids,tag_logic:P.tag_logic});(0,U.Kn)(e)&&(E.value=e.total)},ew=()=>{let e=P.start_time;return(0===B.value||null===e)&&(e=Date.now()),{track_open:1,track_click:1,addresser:P.addresser||"",full_name:P.full_name,subject:P.subject,group_id:P.group_id||0,template_id:P.template_id||0,is_record:P.is_record,unsubscribe:P.unsubscribe,warmup:P.warmup,threads:P.threads,start_time:e/1e3,remark:P.remark,tag_ids:P.tag_ids,tag_logic:P.tag_logic}},eU=async()=>{var e;await (null==(e=O.value)?void 0:e.validate()),$.value?await (0,S.xJ)({task_id:z.value,...ew()}):await (0,S.gI)(ew()),x.push("/market/task")};function eS(e){if(a.query.chat_id){let t=e.find(e=>e.chat_id==a.query.chat_id);t&&(P.template_id=t.id,P.subject=W.temp_subject,ev.value=t.html_content)}}return(async()=>{let{task_id:e,type:t}=a.query;if("edit"===t?(z.value=Number(e),$.value=!0):(z.value=0,$.value=!1),!e)return;let l=await (0,S.mQ)({id:Number(e)});(0,U.Kn)(l)&&(P.addresser=l.addresser,P.full_name=l.full_name,P.subject=l.subject,P.group_id=l.group_id,P.template_id=l.template_id,P.is_record=l.is_record,P.unsubscribe=l.unsubscribe,P.threads=l.threads,q.value=+(0!==l.threads),P.remark=l.remark,P.tag_logic=l.tag_logic,(0,k.Y3)(()=>{P.tag_ids=l.tag_ids}))})(),(e,a)=>{let h=(0,k.up)("router-link"),w=_.Z,U=b.ZP,S=f.ZP,x=g.Z,Z=(0,k.up)("i18n-t"),W=v.Z,M=m.ZP,z=p.Z,D=c.ZP,ew=d.Z,ey=u.Z,ex=o.Z,eZ=r.Z,eW=n.ZP,eO=s.Z,ej=i.Z,eM=l.Z;return(0,k.wg)(),(0,k.iD)("div",L,[(0,k._)("div",A,[(0,k.Wm)(U,{class:"mb-20px"},{default:(0,k.w5)(()=>[(0,k.Wm)(w,null,{default:(0,k.w5)(()=>[(0,k.Wm)(h,{to:"/market/task"},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("market.task.title")),1)]),_:1})]),_:1}),(0,k.Wm)(w,null,{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)((0,k.SU)($)?e.$t("market.task.edit.editTitle"):e.$t("market.task.edit.addTitle")),1)]),_:1})]),_:1}),(0,k._)("div",{class:"task-edit-box",style:(0,k.j5)({minHeight:(0,k.SU)(C)+"px"})},[(0,k.Wm)(ej,{ref_key:"formRef",ref:O,class:"task-edit-form",model:(0,k.SU)(P),rules:R},{default:(0,k.w5)(()=>[(0,k._)("div",{ref_key:"formContentRef",ref:j},[(0,k.Wm)(eW,{class:"mb-24px"},{default:(0,k.w5)(()=>[(0,k.Wm)(S,{label:e.$t("market.task.edit.from")},{default:(0,k.w5)(()=>[(0,k.Wm)(y.Z,{value:(0,k.SU)(P).addresser,"onUpdate:value":a[0]||(a[0]=e=>(0,k.SU)(P).addresser=e),name:(0,k.SU)(P).full_name,"onUpdate:name":a[1]||(a[1]=e=>(0,k.SU)(P).full_name=e)},null,8,["value","name"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.displayName"),path:"full_name"},{default:(0,k.w5)(()=>[(0,k.Wm)(x,{value:(0,k.SU)(P).full_name,"onUpdate:value":a[2]||(a[2]=e=>(0,k.SU)(P).full_name=e),placeholder:e.$t("market.task.edit.displayNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.subject"),path:"subject"},{default:(0,k.w5)(()=>[(0,k.Wm)(x,{value:(0,k.SU)(P).subject,"onUpdate:value":a[3]||(a[3]=e=>(0,k.SU)(P).subject=e),placeholder:e.$t("market.task.edit.subjectPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.recipients"),type:"group_ids"},{default:(0,k.w5)(()=>[(0,k._)("div",K,[(0,k._)("div",V,[(0,k.Wm)(N,{value:(0,k.SU)(P).group_id,"onUpdate:value":a[4]||(a[4]=e=>(0,k.SU)(P).group_id=e),label:(0,k.SU)(H),"onUpdate:label":a[5]||(a[5]=e=>(0,k.dq)(H)?H.value=e:null),disabled:(0,k.SU)($)},null,8,["value","label","disabled"])]),(0,k.Wm)(Z,{class:"mt-8px",tag:"div",scope:"global",keypath:"market.task.edit.recipientsCount"},{count:(0,k.w5)(()=>[(0,k._)("b",null,(0,k.zw)((0,k.SU)(E)),1)]),_:1})])]),_:1},8,["label"]),(0,k.Wm)(z,{cols:24,"x-gap":24},{default:(0,k.w5)(()=>[(0,k.Wm)(M,{span:6,label:e.$t("market.task.edit.tagLogic"),path:"tag_logic"},{default:(0,k.w5)(()=>[(0,k.Wm)(W,{value:(0,k.SU)(P).tag_logic,"onUpdate:value":[a[6]||(a[6]=e=>(0,k.SU)(P).tag_logic=e),a[7]||(a[7]=()=>eh())],options:T,disabled:(0,k.SU)($)},null,8,["value","disabled"])]),_:1},8,["label"]),(0,k.Wm)(M,{span:18,label:e.$t("market.task.edit.tags"),path:"tag_ids"},{default:(0,k.w5)(()=>[(0,k.Wm)(I,{value:(0,k.SU)(P).tag_ids,"onUpdate:value":[a[8]||(a[8]=e=>(0,k.SU)(P).tag_ids=e),a[9]||(a[9]=()=>eh())],"group-id":(0,k.SU)(P).group_id,disabled:(0,k.SU)($)},null,8,["value","group-id","disabled"])]),_:1},8,["label"])]),_:1}),(0,k.Wm)(S,{label:e.$t("market.task.edit.template"),path:"template_id"},{default:(0,k.w5)(()=>[(0,k._)("div",Y,[(0,k.Wm)(F.Z,{value:(0,k.SU)(P).template_id,"onUpdate:value":a[10]||(a[10]=e=>(0,k.SU)(P).template_id=e),content:(0,k.SU)(ev),"onUpdate:content":a[11]||(a[11]=e=>(0,k.dq)(ev)?ev.value=e:null),onListReady:eS},null,8,["value","content"])]),(0,k.Wm)(D,{text:"",type:"primary",class:"ml-12px",onClick:eg},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)((0,k.SU)(t)("common.actions.create")),1)]),_:1})]),_:1},8,["label"]),(0,k.kq)("",!0),(0,k.Wm)(S,{label:(0,k.SU)(t)("market.task.edit.ipWarmup")},{default:(0,k.w5)(()=>[(0,k.Wm)(ew,{value:(0,k.SU)(P).warmup,"onUpdate:value":a[13]||(a[13]=e=>(0,k.SU)(P).warmup=e),"checked-value":1,"unchecked-value":0},null,8,["value"]),(0,k._)("span",X,(0,k.zw)((0,k.SU)(t)("market.task.edit.ipWarmupTip")),1)]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.unsubscribeLink")},{default:(0,k.w5)(()=>[(0,k.Wm)(ew,{value:(0,k.SU)(P).unsubscribe,"onUpdate:value":a[14]||(a[14]=e=>(0,k.SU)(P).unsubscribe=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.threads"),"show-feedback":!1},{default:(0,k.w5)(()=>[(0,k.Wm)(ex,{value:(0,k.SU)(q),"onUpdate:value":[a[15]||(a[15]=e=>(0,k.dq)(q)?q.value=e:null),ef]},{default:(0,k.w5)(()=>[(0,k.Wm)(ey,{value:0},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("market.task.edit.threadsAuto")),1)]),_:1}),(0,k.Wm)(ey,{value:1},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("market.task.edit.threadsCustom")),1)]),_:1})]),_:1},8,["value"]),(0,k.wy)((0,k._)("div",J,[(0,k.Wm)(eZ,{value:(0,k.SU)(P).threads,"onUpdate:value":a[16]||(a[16]=e=>(0,k.SU)(P).threads=e),min:1,max:100,"show-button":!1},null,8,["value"])],512),[[k.F8,1===(0,k.SU)(q)]])]),_:1},8,["label"])]),_:1}),(0,k.Wm)(eW,null,{default:(0,k.w5)(()=>[(0,k.Wm)(S,{label:(0,k.SU)(t)("market.task.edit.sendTime"),path:"start_time"},{default:(0,k.w5)(()=>[(0,k.Wm)(ex,{value:(0,k.SU)(B),"onUpdate:value":[a[18]||(a[18]=e=>(0,k.dq)(B)?B.value=e:null),eb],class:"flex items-center"},{default:(0,k.w5)(()=>[(0,k.Wm)(ey,{value:0},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)((0,k.SU)(t)("market.task.edit.sendTimeNow")),1)]),_:1}),(0,k.Wm)(ey,{class:"items-center",value:1}),(0,k.Wm)(eO,{value:(0,k.SU)(P).start_time,"onUpdate:value":a[17]||(a[17]=e=>(0,k.SU)(P).start_time=e),class:"ml-8px",type:"datetime",disabled:0===(0,k.SU)(B)},null,8,["value","disabled"])]),_:1},8,["value"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.remark")},{default:(0,k.w5)(()=>[(0,k.Wm)(x,{value:(0,k.SU)(P).remark,"onUpdate:value":a[19]||(a[19]=e=>(0,k.SU)(P).remark=e),placeholder:e.$t("market.task.edit.remarkPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.testEmail"),"show-feedback":!1},{default:(0,k.w5)(()=>[(0,k._)("div",Q,[(0,k.Wm)(x,{value:(0,k.SU)(G),"onUpdate:value":a[20]||(a[20]=e=>(0,k.dq)(G)?G.value=e:null),placeholder:e.$t("market.task.edit.testEmailPlaceholder")},null,8,["value","placeholder"])]),(0,k.Wm)(D,{onClick:e_},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("market.task.edit.sendTest")),1)]),_:1})]),_:1},8,["label"])]),_:1})],512)]),_:1},8,["model"]),(0,k._)("div",ee,[(0,k.Wm)(eW,{class:"h-full","content-style":{display:"flex",flexDirection:"column",height:"100%"}},{default:(0,k.w5)(()=>[(0,k._)("div",et,[(0,k._)("div",ea,[(0,k._)("div",el,(0,k.zw)((0,k.SU)(t)("market.task.edit.from"))+":",1),(0,k._)("div",ei,(0,k.zw)((0,k.SU)(P).addresser),1)]),(0,k._)("div",es,[(0,k._)("div",en,(0,k.zw)((0,k.SU)(t)("market.task.edit.to"))+":",1),(0,k._)("div",er,(0,k.zw)((0,k.SU)(H)||"--"),1)]),(0,k._)("div",eo,[(0,k._)("div",eu,(0,k.zw)((0,k.SU)(t)("market.task.edit.subject"))+":",1),(0,k._)("div",ed,(0,k.zw)((0,k.SU)(P).subject||"--"),1)])]),(0,k._)("div",ec,[(0,k.SU)(ev)?((0,k.wg)(),(0,k.j4)(eM,{key:0,value:(0,k.SU)(ev)},null,8,["value"])):((0,k.wg)(),(0,k.iD)("div",ep,(0,k.zw)((0,k.SU)(t)("market.task.edit.preview.empty")),1))])]),_:1})])],4)]),(0,k._)("div",em,[(0,k.Wm)(D,{type:"primary",onClick:eU},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("common.actions.confirm")),1)]),_:1}),(0,k.Wm)(D,{class:"ml-16px",secondary:"",onClick:ek},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("common.actions.back")),1)]),_:1})])])}}}),eg=(0,R.default)(ev,[["__scopeId","data-v-54384274"]])}}]);